===================================================
ASSISTENTE DE VOZ CHICA COM AVATAR - MANUAL DE INSTALA√á√ÉO
===================================================

üìã REQUISITOS DO SISTEMA
===================================================

1. üêç Python 3.8 ou superior
2. üíæ 8GB RAM m√≠nimo (16GB recomendado)
3. üé§ Microfone funcionando
4. üîä Alto-falantes funcionando
5. üåê Conex√£o com internet (para baixar modelos)
6. üñ•Ô∏è Sistema gr√°fico (para o avatar)

‚öôÔ∏è INSTALA√á√ÉO DAS DEPEND√äNCIAS
===================================================

1. Primeiro, instale o Python 3.8+ se ainda n√£o tiver:
   - Windows: https://www.python.org/downloads/
   - macOS: `brew install python`
   - Linux: `sudo apt install python3 python3-pip`

2. Crie um ambiente virtual (recomendado):
   ```bash
   python -m venv venv
   
   # Windows
   venv\Scripts\activate
   
   # macOS/Linux
   source venv/bin/activate
   ```

3. Instale as depend√™ncias Python:
   ```bash
   pip install -r requirements.txt
   ```

4. Instale depend√™ncias do sistema para o Pygame (avatar):
   
   **macOS:**
   ```bash
   brew install sdl2 sdl2_image sdl2_mixer sdl2_ttf portaudio
   ```
   
   **Ubuntu/Debian:**
   ```bash
   sudo apt-get install python3-dev libsdl2-dev libsdl2-image-dev libsdl2-mixer-dev libsdl2-ttf-dev portaudio19-dev
   ```
   
   **Windows:**
   - Baixe os instaladores do Pygame e SDL2 do site oficial

üîß INSTALA√á√ÉO DO OLLAMA (OBRIGAT√ìRIO)
===================================================

O Ollama √© necess√°rio para o modelo de linguagem local.

1. üì• Baixe e instale o Ollama:
   - Site oficial: https://ollama.ai/
   - Ou use os comandos abaixo:

   ```bash
   # macOS
   curl -fsSL https://ollama.ai/install.sh | sh
   
   # Linux
   curl -fsSL https://ollama.ai/install.sh | sh
   
   # Windows (PowerShell como administrador)
   winget install Ollama.Ollama
   ```

2. üöÄ Inicie o servi√ßo Ollama:
   ```bash
   # Em um terminal separado
   ollama serve
   ```

3. üì¶ Baixe um modelo (recomendado):
   ```bash
   # Modelo em portugu√™s recomendado
   ollama pull llama3.2:3b
   
   # Ou modelos alternativos
   ollama pull mistral:7b
   ollama pull gemma:2b
   ```

üéØ CONFIGURA√á√ÉO DO PROGRAMA
===================================================

1. üìù Todas as configura√ß√µes est√£o centralizadas no arquivo `config.py`:

   ```python
   # Configura√ß√µes gerais
   ASSISTANT_NAME = "Chica"
   ASSISTANT_GREETING = " Eu sou a Chica, sua assistente. Como posso ajudar?"
   
   # Configura√ß√µes do avatar
   AVATAR_ENABLE = True  # True: habilita a janela do avatar, False: desabilita o avatar completamente
   AVATAR_WINDOW_SIZE_CM = 7  # Tamanho da janela em cent√≠metros
   AVATAR_IMAGE_DIR = "chica_img"  # Pasta com as imagens do avatar
   AVATAR_BLINK_INTERVAL = 3.0  # Segundos entre piscadas
   AVATAR_SPEAK_ANIMATION_SPEED = 0.1  # Velocidade da anima√ß√£o de fala
   
   # Configura√ß√µes de √°udio
   SAMPLE_RATE = 16000
   CHANNELS = 1
   CHUNK = 1024
   AUDIO_DEVICE = "Isolamento de Voz"  # Nome do dispositivo de √°udio
   
   # Palavras de ativa√ß√£o
   WAKE_WORDS = [
       "ol√° chica", "ei chica", "chica", "ok chica",
       "shika", "shica", "hei chica", "hei shica"
   ]
   
   # Configura√ß√µes dos modelos
   OLLAMA_MODEL = 'llama3.2:3b'
   WHISPER_MODEL = 'base'
   TTS_VOICE = 'pf_dora 80% mais if_sara 20%'
   ```

2. üé§ Teste seu microfone:
   ```bash
   python -c "import sounddevice as sd; print(sd.query_devices())"
   ```

3. üñºÔ∏è Verifique as imagens do avatar:
   - Certifique-se que a pasta `chica_img/` cont√©m:
     - `chica_normal.png` (estado inicial)
     - `chica_olho.png` (piscar)
     - `chica_boca.png` (falando)
     - `chica_olho_boca.png` (piscar enquanto fala)

üöÄ EXECUTANDO O PROGRAMA
===================================================

1. Certifique-se que o Ollama est√° rodando:
   ```bash
   ollama serve
   ```

2. Execute o assistente com avatar:
   ```bash
   python app.py
   ```

3. Comandos de voz:
   - "ol√° chica" - Para acordar a assistente
   - "pare" ou "para" - Para interromper a fala
   - Sil√™ncio de 15 segundos - Volta a dormir

4. Interface do avatar:
   - Janela de 7x7cm com anima√ß√µes sincronizadas com a fala
   - Piscadas naturais quando n√£o est√° falando
   - Anima√ß√£o de fala alternando entre boca aberta e fechada
   - **Controle de habilita√ß√£o**: Use `AVATAR_ENABLE = False` no `config.py` para desativar completamente o avatar (√∫til para sistemas sem interface gr√°fica ou para economizar recursos)

üéõÔ∏è CONFIGURA√á√ïES AVAN√áADAS
===================================================

1. Para usar GPU (se dispon√≠vel):
   ```bash
   # Desinstale PyTorch atual
   pip uninstall torch
   
   # Instale PyTorch com CUDA (NVIDIA)
   pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
   
   # Ou para Apple Silicon
   pip install torch torchvision torchaudio
   ```

2. Configura√ß√µes de voz:
   - Voz √∫nica: `'pf_dora'`
   - Voz mista: `'pf_dora 80% mais if_sara 20%'`
   - Outras vozes dispon√≠veis no Kokoro

3. Configura√ß√µes do processamento do thinking:
   ```python
   # ============================================================================
   # CONFIGURA√á√ÉO DE THINKING (PROCESSAMENTO DO MODELO)
   # ============================================================================

   THINKING_ENABLED = True              # Ativa/desativa o modo thinking do modelo True ou False
   THINKING_TIMEOUT = 30                # Timeout em segundos para processamento do thinking
   ```
   - `THINKING_ENABLED`: Controla se o sistema processa o campo `thinking` dos modelos
   - `THINKING_TIMEOUT`: Tempo m√°ximo para processar respostas complexas

4. Tamanho do avatar:
   - Modifique `AVATAR_WINDOW_SIZE_CM` no `config.py`
   - O tamanho √© automaticamente convertido para pixels

ÔøΩ ARQUITETURA DO SISTEMA
===================================================

üìÅ Estrutura de arquivos:
```
kokoro/
‚îú‚îÄ‚îÄ app.py              # Programa principal com avatar
‚îú‚îÄ‚îÄ config.py            # Configura√ß√µes centralizadas
‚îú‚îÄ‚îÄ requirements.txt     # Depend√™ncias Python
‚îú‚îÄ‚îÄ leiame.txt          # Este manual
‚îú‚îÄ‚îÄ README.md           # Documenta√ß√£o em ingl√™s
‚îî‚îÄ‚îÄ chica_img/          # Imagens do avatar
    ‚îú‚îÄ‚îÄ chica_normal.png
    ‚îú‚îÄ‚îÄ chica_olho.png
    ‚îú‚îÄ‚îÄ chica_boca.png
    ‚îî‚îÄ‚îÄ chica_olho_boca.png
```

üîÑ Fluxo do sistema:
1. Wake word detection ‚Üí 2. STT (Whisper) ‚Üí 3. LLM (Ollama) ‚Üí 4. TTS (Kokoro) ‚Üí 5. Avatar animation

üéØ DICAS DE USO
===================================================

1. Fale claramente e em um ambiente silencioso
2. Aguarde o "beep" antes de falar
3. Use frases completas para melhores respostas
4. O avatar ajuda a visualizar quando a assistente est√° falando
5. Para interromper, diga "pare" ou "para"

ÔøΩ MODELOS SUPORTADOS E PROCESSAMENTO DO THINKING
===================================================

O sistema suporta v√°rios modelos do Ollama com processamento inteligente:

1. **Modelos com thinking (racioc√≠nio interno):**
   - `qwen3:0.6b` - Usa campo `thinking` para racioc√≠nio complexo
   - Outros modelos que implementam o padr√£o thinking

2. **Modelos sem thinking:**
   - `llama3.2:3b` - Respostas diretas no campo `content`
   - `mistral:7b` - Respostas diretas
   - `gemma:2b` - Respostas diretas

3. **Processamento inteligente do thinking:**
   - ‚úÖ **Extra√ß√£o de respostas**: Extrai a resposta final do campo `thinking`
   - ‚úÖ **Detec√ß√£o de repeti√ß√£o**: Evita repetir respostas anteriores
   - ‚úÖ **Filtragem de racioc√≠nio**: Remove linhas de racioc√≠nio interno
   - ‚úÖ **Fallback inteligente**: M√∫ltiplas estrat√©gias de extra√ß√£o

4. **Configura√ß√£o do thinking:**
   - Ative/desative com `THINKING_ENABLED` no `config.py`
   - Ajuste o timeout com `THINKING_TIMEOUT` (padr√£o: 30 segundos)

ÔøΩü§ù CONTRIBUI√á√ÉO
===================================================

Para reportar problemas ou sugerir melhorias:
1. Verifique se o problema j√° foi reportado
2. Inclua informa√ß√µes do sistema
3. Descreva os passos para reproduzir o problema
4. Inclua mensagens de erro completas

üìû SUPORTE
===================================================

Para ajuda adicional:
- Consulte este manual
- Verifique as mensagens de erro no terminal
- Teste componentes individualmente
- Consulte a documenta√ß√£o das bibliotecas